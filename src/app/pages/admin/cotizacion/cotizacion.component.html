<div class="container mt-4">
  <h2>Nueva Cotización</h2>
  <form [formGroup]="cotizacionForm" (ngSubmit)="onSubmit()">

    <!-- Registro Section -->
    <div class="section mb-4">
      <h3>Registro</h3>
      <div class="row">
        <div class="col-md-4 mb-3">
          <label for="periodo">Periodo</label>
          <input type="text" id="periodo" class="form-control" formControlName="periodo" placeholder="Ej: 2024-12">
        </div>
        <div class="col-md-4 mb-3">
          <label for="serie">Serie</label>
          <input type="text" id="serie" class="form-control" formControlName="serie" placeholder="Ej: C001">
        </div>
        <div class="col-md-4 mb-3">
          <label for="numero">Número</label>
          <input type="number" id="numero" class="form-control" formControlName="numero" placeholder="Ej: 12345">
        </div>
      </div>

      <div class="row">
        <div class="col-md-4 mb-3">
          <label for="fecha">Fecha</label>
          <input type="date" id="fecha" class="form-control" formControlName="fecha">
        </div>
        <div class="col-md-4 mb-3">
          <label for="TC">Tipo de Cambio (TC)</label>
          <input type="number" step="0.01" id="TC" class="form-control" formControlName="TC" placeholder="Ej: 3.85">
        </div>
        <div class="col-md-4 mb-3">
          <label for="punto_venta">Punto de Venta</label>
          <input type="text" id="punto_venta" class="form-control" formControlName="punto_venta" placeholder="Lima">
        </div>
      </div>
    </div>

    <!-- Cliente Section -->
    <div class="section mb-4">
      <h3>Cliente</h3>
      <div class="row">
        <div class="col-md-4 mb-3">
          <label for="dni_ruc">DNI o RUC</label>
          <input type="text" id="dni_ruc" class="form-control" formControlName="dni_ruc" placeholder="123456789">
        </div>
        <div class="col-md-4 mb-3">
          <label for="razon_social">Razón Social</label>
          <input type="text" id="razon_social" class="form-control" formControlName="razon_social" placeholder="Empresa S.A.">
        </div>
        <div class="col-md-4 mb-3">
          <label for="gmail">Email</label>
          <input type="email" id="gmail" class="form-control" formControlName="gmail" placeholder="cliente@example.com">
        </div>
      </div>

      <div class="row">
        <div class="col-md-4 mb-3">
          <label for="telefono">Teléfono</label>
          <input type="text" id="telefono" class="form-control" formControlName="telefono" placeholder="987654321">
        </div>
      </div>
    </div>

    <!-- Detalles Section -->
    <div class="section mb-4">
      <h3>Detalles</h3>
      <div class="row">
        <div class="col-md-4 mb-3">
          <label for="forma_pago">Forma de Pago</label>
          <input type="text" id="forma_pago" class="form-control" formControlName="forma_pago" placeholder="Contado">
        </div>
        <div class="col-md-4 mb-3">
          <label for="dias_oferta">Días de Oferta</label>
          <input type="number" id="dias_oferta" class="form-control" formControlName="dias_oferta">
        </div>
        <div class="col-md-4 mb-3">
          <label for="moneda">Moneda</label>
          <input type="text" id="moneda" class="form-control" formControlName="moneda" placeholder="PEN">
        </div>
      </div>

      <div class="row">
        <div class="col-md-4 mb-3">
          <label for="observacion">Observación</label>
          <input type="text" id="observacion" class="form-control" formControlName="observacion" placeholder="Entrega en 7 días">
        </div>
        <div class="col-md-4 mb-3">
          <label for="id_producto">Código de Producto</label>
          <input type="number" id="id_producto" class="form-control" formControlName="id_producto">
        </div>
        <div class="col-md-4 mb-3">
          <label for="cantidad_producto">Cantidad Producto</label>
          <input type="number" id="cantidad_producto" class="form-control" formControlName="cantidad_producto">
        </div>
      </div>

      <div class="row">
        <div class="col-md-4 mb-3">
          <label for="precio_producto">Precio Producto</label>
          <input type="number" step="0.01" id="precio_producto" class="form-control" formControlName="precio_producto">
        </div>
        <div class="col-md-4 mb-3">
          <label for="descuento">Descuento (%)</label>
          <input type="number" step="0.01" id="descuento" class="form-control" formControlName="descuento">
        </div>
        <!-- <div class="col-md-4 mb-3">
          <label for="precio_total">Precio Total</label>
          <input type="number" step="0.01" id="precio_total" class="form-control" formControlName="precio_total">
        </div> -->
      </div>
    </div>

    <button type="submit" class="btn btn-primary" [disabled]="cotizacionForm.invalid">
      {{ editingCotizacion ? 'Actualizar Cotización' : 'Crear Cotización' }}
    </button>
    <button *ngIf="editingCotizacion" type="button" class="btn btn-secondary ml-2" (click)="resetForm()">Cancelar</button>
  </form>
</div>

<div class="container mt-4">
  <h2 class="mb-3">Lista de Cotizaciones</h2>
  <table class="table table-striped table-bordered">
    <thead class="thead-dark">
      <tr>
        <th>Periodo</th>
        <th>Serie</th>
        <th>Número</th>
        <th>Fecha</th>
        <th>TC</th>
        <th>Punto Venta</th>
        <th>DNI/RUC</th>
        <th>Razón Social</th>
        <th>Precio Total</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let cotizacion of cotizaciones">
        <td>{{ cotizacion.periodo }}</td>
        <td>{{ cotizacion.serie }}</td>
        <td>{{ cotizacion.numero }}</td>
        <td>{{ cotizacion.fecha | date  }}</td>
        <td>{{ cotizacion.TC }}</td>
        <td>{{ cotizacion.punto_venta }}</td>
        <td>{{ cotizacion.dni_ruc }}</td>
        <td>{{ cotizacion.razon_social }}</td>
        <td>{{ cotizacion.precio_total }}</td>
        <td class="action-icons">
          <i class="fas fa-edit"  (click)="editCotizacion(cotizacion)"></i>
          <!-- Botón de eliminar -->
          <i class="fas fa-trash" (click)="deleteCotizacion(cotizacion.id)"></i>
      </td>
      </tr>
    </tbody>
  </table>
</div>
